<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forschungsantr√§ge</title>
    <style>
    </style>
</head>

<body>

        <canvas id="myChart" width="400" height="400"></canvas>


        <script src="https://code.jquery.com/jquery-3.2.1.min.js" type="text/javascript"></script>
        <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js" integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
            crossorigin="anonymous"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" type="text/javascript" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"
            crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.0/Chart.bundle.min.js" type="text/javascript"></script>
        <script src="src/dynamicgraph.js" type="text/javascript"></script>
        <script>
        /*const helper = new DynamicGraph("myChart");

        const map = new Map();
        map.set('first', "Robin");
        map.set('last', "Weitzel");

        const data = [
            ['sum', 'user', 'time'],
            [10, {id: 1, name: map}, 1],
            [2, {id: 2, name: {first: 'Jonas', last: 'Weitzel'}}, 2],
            [5, {id: 3, name: {first: 'Robin', last: 'Weitzel'}}, 3]
        ];

        const data2 = {
            user: map,
            values: [1, 2, 3, 4, 5],
            colors: ['blue', 'blue', 'green', 'yellow', 'red'],
            id: 2
        };

        const data3 = 
        {project: [{
                id: 1,
                steps: [1, 2, 3]
            },
            {
                id: 2,
                steps: [1]
            },
            {
                id: 3,
                steps: [2]
            },
            {
                id: 4,
                steps: [3]
            },
            {
                id: 5,
                steps: [5]
            }]
        };

        const options = {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: true
                        }
                    }]
                },
                responsive: false
            };
        //helper.createGraphFromArray('bar', data, ['usernamefirst'], ['sum'], [{label: 'user', function: 'return d === "a" || d === "b"'}]);
        //helper.createGraphFromObject('bar', data2, ['colors'], ['values'], [{label: 'values', condition: '!== 2'}]);
        //helper.createGraphFromObject('bar', data3, ['projectid'], [{label: 'projectsteps', mode: "avg"}], []);
        let labels = helper.loadObject(data3);
        //alert(JSON.stringify(labels));
        helper.createGraphFromMemory('pie', ['projectid'], ['projectsteps'], []);*/

       // Example data
       const map = new Map();
       map.set('first', "David");
       map.set('last', "Miller");

   const data = [
       ['sum', 'user', 'time'],
       [10, {id: 1, name: map}, 1],
       [2, {id: 2, name: {first: 'Alex', last: 'Miller'}}, 2],
       [5, {id: 3, name: {first: 'Julia', last: 'Smith'}}, 3]
   ];

   // Graph.js options
   const options = {
           scales: {
               yAxes: [{
                   ticks: {
                       beginAtZero: true
                   }
               }]
           },
           responsive: false
       };


const graph = new DynamicGraph("myChart");

const f = (array, pos) => {
    const mode = {};
    let maxOccurance = 0;
    let maxOccuranceValue;

    array.forEach(a => {
        mode[a[pos]] = mode[a[pos]] ? mode[a[pos]] + 1 : 1;

        if(maxOccurance < mode[a[pos]]) {
            maxOccurance = mode[a[pos]];
            maxOccuranceValue = a[pos];
        }
    });
    return maxOccuranceValue;
};

const yDimension = [{label: 'sum', function: f}];

graph.createGraphFromArray('bar', data, 'usernamelast', yDimension, [], 'blue', options);
        </script>
</body>
</html>